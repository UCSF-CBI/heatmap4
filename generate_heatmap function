\name{generate_heatmap}

\description{A heat map is a false color image (basically image(t(x))) with a dendrogram added to the left side and to the top. Typically, reordering of the rows and columns according to some set of values (row or column means) within the restrictions imposed by the dendrogram is carried out.}

\usage{generate_heatmap <- function(x, col_lab = c(TRUE, FALSE), row_lab = c(TRUE, FALSE), col_lab_vtr = NULL, row_lab_vtr = NULL, col_anno = c(TRUE, FALSE), 
                           row_anno = c(TRUE, FALSE), col_info = NULL, row_info = NULL, col_anno_var = NULL, row_anno_var = NULL, col_var_info = NULL, 
                           row_var_info = NULL, col_dend = c(TRUE, FALSE), row_dend = c(TRUE, FALSE), col_clust = c(TRUE,FALSE), row_clust = c(TRUE, FALSE), 
                           plot_info = c("sideLabCol" = NULL, "sideLabRow" = NULL, "cexColSide" = NULL, "cexRowSide" =NULL), file_name = NULL, ...)}
                          
\arguments{
  \item{x}{numeric matrix of the values to be plotted}
  \item{col_lab}{column labels -> TRUE/FALSE}
  \item{row_lab}{row labels -> TRUE/FALSE}
  \item{col_lab_vtr}{default = colnames(x), character vector}
  \item{row_lab_vtr}{default = rownames(x), character vector}
  \item{col_anno}{column annotations -> TRUE/FALSE}
  \item{row_anno}{row annotations -> TRUE/FALSE}
  \item{row_info}{data used in row annotations}
  \item{col_info}{data used in column annotations}
  \item{col_anno_var}{limits columns annotations, default = colnames(col_info)}
  \item{row_anno_var}{limits row annotations, default = rownames(col_info)}
  \item{col_var_info}{list of column color + variables}
  \item{row_var_info}{list of row color + variables}
  \item{col_dend}{column dendogram -> TRUE/FALSE}
  \item{row_dend}{row dendogram -> TRUE/FALSE}
  \item{col_clust}{cluster by column, variable of dend/hclust}
  \item{row_clust}{cluster by row, variable of dend/hclust}
  \item{plot_info}{variables to control - sideLabCol, sideLabRow, cexColSide, cexRowSide}
}

\details{
If either Rowv or Colv are dendrograms they are honored (and not reordered). Otherwise, dendrograms are computed as dd <- as.dendrogram(hclustfun(distfun(X))) where X is either x or t(x).

If either is a vector (of ‘weights’) then the appropriate dendrogram is reordered according to the supplied values subject to the constraints imposed by the dendrogram, 

by reorder(dd, Rowv), in the row case. If either is missing, as by default, then the ordering of the corresponding dendrogram is by the mean value of the rows/columns,

i.e., in the case of rows, Rowv <- rowMeans(x, na.rm = na.rm). If either is NA, no reordering will be done for the corresponding side.
}

\value{
  \item{rowInd}{row index permutation vector}
  \item{colInd}{column index permutation vector}
  \item{Rowv}{row dendrogram, only when Rowv is not NA + keep.dendro = true}
  \item{Colv}{column dendrogram, only when Rowv is not NA + keep.dendro = true}
}

\note{

Unless Rowv = NA (or Colw = NA), the original rows and columns are reordered in any case to match the dendrogram, e.g., 

the rows by order.dendrogram(Rowv) where Rowv is the (possibly reorder()ed) row dendrogram. heatmap() uses layout and draws the image in

the lower right corner of a 2x2 layout. Consequentially, it can not be used in a multi column/row layout, i.e., when par(mfrow = *) or (mfcol = *) has been called.
}

