---
title: "HeatmapExample"
author: "Anishka Dhar"
date: "9/31/2021"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Vignette Title}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```
##Introdcution
Generate_heatmap example using formate from the help file with data set "morley"

``` {r}
library(RColorBrewer)
library(marray)
```

```{r include=FALSE}
source("./heatmap4.R")
## Wrapped heatmap function
generate_heatmap <- function(x, col_lab = c(TRUE, FALSE), row_lab = c(TRUE, FALSE), col_lab_vtr = NULL,
                             row_lab_vtr = NULL, col_anno = c(TRUE, FALSE), row_anno = c(TRUE, FALSE), col_info = NULL,
                             row_info = NULL, col_anno_var = NULL, row_anno_var = NULL, col_var_info = NULL,
                             row_var_info = NULL, col_dend = c(TRUE, FALSE), row_dend = c(TRUE, FALSE) ...)
```


```{r, echo=FALSE}
if (F) {
  ## Calling Bioconductor
  if (!requireNamespace("BiocManager", quietly = TRUE))
    install.packages("BiocManager")
  BiocManager::install("marray")
  load("../data.RData")
}
```

```{r}
## Main numeric matrix
x <- as.matrix(morley)
## Column annotation df
set.seed(575)
anno_rows <- ncol(morley)
anno_columns <- 4
random_data <- rnorm(anno_rows*anno_columns)
annotation_df <- matrix(data = random_data, nrow = anno_rows, ncol = anno_columns)
colnames(annotation_df) <- c('C1', 'C2', 'C3','C4')
annotation_df <- as.data.frame(annotation_df)
```

```{r}
##heatmap example with column annotations
generate_heatmap(x, col_info = annotation_df, row_anno = FALSE, col_anno = TRUE, row_lab = TRUE, col_lab = TRUE, row_dend = FALSE, col_dend = TRUE)
```
